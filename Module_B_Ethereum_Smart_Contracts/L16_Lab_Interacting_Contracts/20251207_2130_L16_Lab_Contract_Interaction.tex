\documentclass[8pt,aspectratio=169]{beamer}
\usetheme{Madrid}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{hyperref}
\usepackage{listings}
\lstset{basicstyle=\tiny\ttfamily,breaklines=true}

\title{L16: Lab - Contract Interaction}
\subtitle{Module B: Ethereum \& Smart Contracts}
\author{Blockchain \& Cryptocurrency Course}
\date{December 2025}

\begin{document}

\begin{frame}
\titlepage
\end{frame}

\begin{frame}{Learning Objectives}
By the end of this lab, you will be able to:
\begin{itemize}
\item Navigate and use Remix IDE for smart contract development
\item Deploy a SimpleStorage contract in Remix VM
\item Interact with deployed contracts (read and write functions)
\item Connect MetaMask to Remix and deploy to Sepolia testnet
\item Verify deployed contracts on Etherscan
\item Debug transaction failures using Remix and Etherscan
\end{itemize}
\end{frame}

\begin{frame}{Lab Overview}
\textbf{What we'll build:}
\begin{itemize}
\item Deploy a SimpleStorage contract that stores key-value pairs
\item Test contract functionality locally
\item Deploy to Sepolia testnet
\item Verify contract on Etherscan
\item Interact with contract via Etherscan UI
\end{itemize}

\vspace{0.3cm}
\textbf{Tools Required:}
\begin{itemize}
\item Remix IDE (remix.ethereum.org)
\item MetaMask browser extension
\item Sepolia testnet ETH (from faucet)
\item Etherscan account (for verification)
\end{itemize}

\vspace{0.3cm}
\textbf{Estimated Time:} 45-60 minutes
\end{frame}

\begin{frame}{Remix IDE Overview}
\textbf{Remix is a web-based Solidity IDE with:}

\vspace{0.3cm}
\begin{itemize}
\item \textbf{File Explorer:} Create and manage Solidity files
\item \textbf{Solidity Compiler:} Compile contracts to bytecode
\item \textbf{Deploy \& Run:} Deploy and interact with contracts
\item \textbf{Plugin Manager:} Add tools (debugger, static analyzers, Etherscan verifier)
\item \textbf{Terminal:} View transaction logs and errors
\end{itemize}

\vspace{0.3cm}
\textbf{Key Features:}
\begin{itemize}
\item No installation required (runs in browser)
\item Multiple VM environments (JavaScript VM, Injected Provider, External HTTP)
\item Built-in debugger with step-through execution
\item Gas estimation and optimization hints
\item Integration with MetaMask, Hardhat, Ganache
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Step 1: Create SimpleStorage Contract}
\textbf{In Remix File Explorer, create \texttt{SimpleStorage.sol}:}

\begin{lstlisting}
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract SimpleStorage {
    // State variable to store a number
    uint256 private storedData;

    // Event emitted when data is updated
    event DataUpdated(uint256 oldValue, uint256 newValue, address updatedBy);

    // Store a number
    function set(uint256 x) public {
        uint256 oldValue = storedData;
        storedData = x;
        emit DataUpdated(oldValue, x, msg.sender);
    }

    // Retrieve the stored number
    function get() public view returns (uint256) {
        return storedData;
    }

    // Increment by a given amount
    function increment(uint256 amount) public {
        uint256 oldValue = storedData;
        storedData += amount;
        emit DataUpdated(oldValue, storedData, msg.sender);
    }
}
\end{lstlisting}
\end{frame}

\begin{frame}{Step 2: Compile the Contract}
\textbf{Using Solidity Compiler tab:}

\vspace{0.3cm}
\begin{enumerate}
\item Click \textbf{Solidity Compiler} icon (left sidebar)

\item Select compiler version: \textbf{0.8.0 or higher}

\item Enable \textbf{Auto compile} (optional but convenient)

\item Click \textbf{Compile SimpleStorage.sol}

\item Check for compilation errors in terminal
\begin{itemize}
\item Green checkmark: Compilation successful
\item Red cross: Syntax or type errors
\end{itemize}

\item Review warnings (if any):
\begin{itemize}
\item Unused variables
\item Shadowing warnings
\item Gas optimization hints
\end{itemize}
\end{enumerate}

\vspace{0.3cm}
\textbf{Successful Compilation:} You'll see ABI and Bytecode available for deployment
\end{frame}

\begin{frame}{Step 3: Deploy in Remix VM}
\textbf{Using Deploy \& Run Transactions tab:}

\vspace{0.3cm}
\begin{enumerate}
\item Click \textbf{Deploy \& Run Transactions} icon

\item Select \textbf{Environment: Remix VM (Shanghai)}
\begin{itemize}
\item In-memory blockchain for testing
\item Pre-funded accounts with 100 ETH each
\item Fast, no real ETH required
\end{itemize}

\item Select \textbf{Account:} One of the pre-funded accounts

\item Set \textbf{Gas Limit:} 3000000 (default is fine)

\item Select \textbf{Contract:} SimpleStorage

\item Click \textbf{Deploy}

\item Check terminal for transaction receipt:
\begin{itemize}
\item Transaction hash
\item Contract address
\item Gas used
\end{itemize}
\end{enumerate}
\end{frame}

\begin{frame}{Step 4: Interact with Deployed Contract}
\textbf{In Deployed Contracts section:}

\vspace{0.3cm}
\textbf{Read Functions (view, free):}
\begin{enumerate}
\item Click \textbf{get} button
\item Should return \texttt{0} (initial value)
\item No gas cost (call, not transaction)
\end{enumerate}

\vspace{0.3cm}
\textbf{Write Functions (state-changing, costs gas):}
\begin{enumerate}
\item Enter \texttt{42} in \textbf{set} input field
\item Click \textbf{set} button
\item Check terminal for transaction details:
\begin{itemize}
\item Gas used: approximately 43,000-45,000
\item Event emitted: DataUpdated(0, 42, your\_address)
\end{itemize}

\item Click \textbf{get} again
\item Should now return \texttt{42}

\item Try \textbf{increment(10)}
\item Click \textbf{get} - should return \texttt{52}
\end{enumerate}
\end{frame}

\begin{frame}{Step 5: Inspect Events}
\textbf{Events are logged in transaction receipts:}

\vspace{0.3cm}
\begin{enumerate}
\item In terminal, click on a transaction hash

\item Expand transaction details:
\begin{itemize}
\item \textbf{status:} 0x1 (success) or 0x0 (failure)
\item \textbf{from:} Your account address
\item \textbf{to:} Contract address
\item \textbf{gas:} Total gas used
\item \textbf{logs:} Array of emitted events
\end{itemize}

\item Expand \textbf{logs[0]}:
\begin{itemize}
\item \textbf{event:} DataUpdated
\item \textbf{args:} [oldValue: 0, newValue: 42, updatedBy: 0x5B38...]
\end{itemize}
\end{enumerate}

\vspace{0.3cm}
\textbf{Use Case:} Events are indexed and searchable off-chain (e.g., by front-end dApps)
\end{frame}

\begin{frame}{Step 6: MetaMask Setup}
\textbf{Prepare MetaMask for testnet deployment:}

\vspace{0.3cm}
\begin{enumerate}
\item Install MetaMask browser extension (metamask.io)

\item Create new wallet or import existing one

\item Switch to \textbf{Sepolia Test Network}:
\begin{itemize}
\item Click network dropdown (top of MetaMask)
\item Enable \textbf{Show test networks} in settings
\item Select \textbf{Sepolia}
\end{itemize}

\item Get test ETH from faucet:
\begin{itemize}
\item Visit sepoliafaucet.com or faucets.chain.link
\item Enter your address
\item Request 0.5 ETH (typically arrives in 30-60 seconds)
\end{itemize}

\item Verify balance in MetaMask shows test ETH
\end{enumerate}

\vspace{0.3cm}
\textbf{Important:} Never send real ETH to test networks! Test ETH has no value.
\end{frame}

\begin{frame}{Step 7: Deploy to Sepolia Testnet}
\textbf{Connect Remix to MetaMask:}

\vspace{0.3cm}
\begin{enumerate}
\item In Remix Deploy tab, change \textbf{Environment} to \textbf{Injected Provider - MetaMask}

\item MetaMask popup appears - click \textbf{Connect}

\item Select account with test ETH

\item Verify Remix shows:
\begin{itemize}
\item Environment: Custom (11155111) network [Sepolia chain ID]
\item Account: Your MetaMask address
\item Balance: Your test ETH amount
\end{itemize}

\item Select \textbf{SimpleStorage} contract

\item Click \textbf{Deploy}

\item MetaMask popup for transaction confirmation:
\begin{itemize}
\item Review gas fee (typically 0.0005-0.002 ETH)
\item Click \textbf{Confirm}
\end{itemize}

\item Wait for transaction confirmation (12-15 seconds on Sepolia)

\item Copy contract address from Remix console
\end{enumerate}
\end{frame}

\begin{frame}{Step 8: Verify Contract on Etherscan}
\textbf{Make source code publicly verifiable:}

\vspace{0.3cm}
\begin{enumerate}
\item Go to \textbf{sepolia.etherscan.io}

\item Paste contract address in search bar

\item Click \textbf{Contract} tab

\item Click \textbf{Verify and Publish}

\item Fill in form:
\begin{itemize}
\item Compiler Type: Solidity (Single file)
\item Compiler Version: Match Remix (e.g., v0.8.20)
\item License Type: MIT
\end{itemize}

\item Paste entire Solidity source code

\item Click \textbf{Verify and Publish}

\item Wait for verification (10-30 seconds)

\item Green checkmark appears: ``Contract Source Code Verified''
\end{enumerate}
\end{frame}

\begin{frame}{Step 9: Interact via Etherscan}
\textbf{Use Etherscan's Read/Write UI:}

\vspace{0.3cm}
\textbf{Read Contract (no wallet needed):}
\begin{enumerate}
\item Click \textbf{Read Contract} tab
\item Click \textbf{get} - shows current stored value
\item No transaction required, instant response
\end{enumerate}

\vspace{0.3cm}
\textbf{Write Contract (requires MetaMask):}
\begin{enumerate}
\item Click \textbf{Write Contract} tab
\item Click \textbf{Connect to Web3} - connects MetaMask
\item Enter value in \textbf{set} input (e.g., 100)
\item Click \textbf{Write}
\item MetaMask popup - confirm transaction
\item Wait for confirmation
\item Go to \textbf{Read Contract} - verify new value
\end{enumerate}

\vspace{0.3cm}
\textbf{Advantage:} No need for custom UI, direct blockchain interaction
\end{frame}

\begin{frame}{Step 10: View Transaction History}
\textbf{Analyze all interactions with your contract:}

\vspace{0.3cm}
\begin{enumerate}
\item On Etherscan contract page, click \textbf{Transactions} tab

\item See list of all transactions:
\begin{itemize}
\item Contract deployment (labeled ``Contract Creation'')
\item All \texttt{set()} and \texttt{increment()} calls
\end{itemize}

\item Click on any transaction hash to see:
\begin{itemize}
\item Block number and timestamp
\item From address (who called function)
\item Gas used and fee paid
\item Input data (encoded function call)
\item Logs (emitted events)
\end{itemize}

\item Click \textbf{Logs} tab in transaction details:
\begin{itemize}
\item See decoded DataUpdated events
\item Indexed parameters are searchable
\end{itemize}
\end{enumerate}
\end{frame}

\begin{frame}{Common Errors and Debugging}
\textbf{Error 1: Transaction Reverted}
\begin{itemize}
\item \textbf{Cause:} require() or assert() failed, out of gas
\item \textbf{Debug:} Check Remix debugger, view revert reason in Etherscan
\item \textbf{Example:} ``Insufficient balance'' error in token transfer
\end{itemize}

\vspace{0.3cm}
\textbf{Error 2: Out of Gas}
\begin{itemize}
\item \textbf{Cause:} Gas limit too low for operation
\item \textbf{Fix:} Increase gas limit in MetaMask advanced settings
\item \textbf{Prevention:} Use Remix gas estimation before deployment
\end{itemize}

\vspace{0.3cm}
\textbf{Error 3: Nonce Too Low}
\begin{itemize}
\item \textbf{Cause:} Pending transaction with same or higher nonce
\item \textbf{Fix:} Wait for pending transaction, or cancel it in MetaMask
\end{itemize}

\vspace{0.3cm}
\textbf{Error 4: Insufficient Funds}
\begin{itemize}
\item \textbf{Cause:} Not enough ETH for gas fees
\item \textbf{Fix:} Get more test ETH from faucet
\end{itemize}
\end{frame}

\begin{frame}{Using Remix Debugger}
\textbf{Step-by-step transaction debugging:}

\vspace{0.3cm}
\begin{enumerate}
\item After transaction executes, click \textbf{Debug} button in terminal

\item Remix Debugger opens with:
\begin{itemize}
\item \textbf{Instructions:} EVM opcodes executed
\item \textbf{Solidity Locals:} Variable values at each step
\item \textbf{Step Detail:} Gas used, stack, memory
\end{itemize}

\item Use controls to navigate:
\begin{itemize}
\item Step over (next instruction)
\item Step into (function call)
\item Step out (return from function)
\item Jump to breakpoint
\end{itemize}

\item Inspect state changes:
\begin{itemize}
\item Hover over variables to see values
\item Check storage changes in real-time
\item Identify where gas is consumed
\end{itemize}
\end{enumerate}

\vspace{0.3cm}
\textbf{Use Case:} Understand why transaction failed or optimize gas usage
\end{frame}

\begin{frame}{Key Takeaways}
\begin{enumerate}
\item \textbf{Remix IDE:} Powerful web-based environment for Solidity development with integrated compiler, debugger, and deployment tools

\item \textbf{Local Testing:} Remix VM provides fast, free testing environment before deploying to real networks

\item \textbf{MetaMask Integration:} Injected Provider connects Remix to testnets and mainnet via MetaMask

\item \textbf{Testnet Deployment:} Sepolia testnet allows realistic testing with free test ETH from faucets

\item \textbf{Etherscan Verification:} Publishing source code enables transparency and direct contract interaction via Etherscan UI

\item \textbf{Debugging:} Remix debugger and Etherscan transaction logs are essential for troubleshooting
\end{enumerate}
\end{frame}

\begin{frame}{Discussion Questions}
\begin{enumerate}
\item Why is it important to test contracts on Remix VM before deploying to testnets?

\item What are the security implications of verifying your contract source code on Etherscan?

\item How would you estimate the gas cost of a complex function before deploying to mainnet?

\item What are the advantages of using events over storing data in state variables for historical records?

\item How would you handle a situation where your contract is deployed but has a critical bug?
\end{enumerate}
\end{frame}

\begin{frame}{Next Lesson Preview: L17 - ERC-20 Token Standard}
\textbf{Coming up next:}
\begin{itemize}
\item Understanding the ERC-20 fungible token standard
\item ERC-20 interface: totalSupply, balanceOf, transfer, approve, transferFrom
\item Implementing ERC-20 from scratch
\item Using OpenZeppelin's ERC-20 implementation
\item Token economics: minting, burning, supply management
\item Real-world examples: USDC, DAI, LINK
\end{itemize}

\vspace{0.3cm}
\textbf{Preparation:}
\begin{itemize}
\item Keep your Remix IDE and MetaMask setup
\item Review events and mappings from L15
\item Browse existing ERC-20 tokens on Etherscan (e.g., USDC)
\end{itemize}
\end{frame}

\end{document}
